{"ast":null,"code":"/**\n * AdminOrders Component\n *\n * Authors: Dawid Olko & Piotr Smoła\n * Date: 2025-11-02\n * Version: 2.0\n *\n * Admin panel component for order management and monitoring in the e-commerce system.\n * Provides comprehensive order tracking, status updates, and analytics dashboard.\n *\n * Features:\n *   - Real-time order list with status tracking\n *   - Order status management (Pending → Shipped → Delivered)\n *   - Search functionality (by order ID, status, date)\n *   - Sorting by multiple fields (ID, date, status, total)\n *   - Pagination (10 orders per page)\n *   - Order statistics dashboard:\n *     * Total orders count\n *     * Pending orders count\n *     * Shipped orders count\n *     * Delivered orders count\n *   - Order details view (expandable rows)\n *   - Product list per order\n *   - Order total calculation\n *   - Date formatting and display\n *\n * Order Status Flow:\n *   1. Pending - Initial state when order is created\n *   2. Shipped - Order has been dispatched\n *   3. Delivered - Order has been delivered to customer\n *\n * State Management:\n *   - orders: Array of all orders from database\n *   - stats: Dashboard statistics (total, pending, shipped, delivered)\n *   - filteredOrders: Orders after search/filter/sort operations\n *   - searchTerm: Current search query\n *   - sortField: Active sorting field (id, date_order, status, total)\n *   - sortDirection: Sort direction ('asc' or 'desc')\n *   - currentPage: Active pagination page\n *   - loading: Loading state for async operations\n *\n * API Endpoints:\n *   - GET /api/orders/ - Fetch all orders (admin only)\n *   - PUT /api/orders/:id/ - Update order status\n *   - DELETE /api/orders/:id/ - Delete order\n *\n * Calculations:\n *   - Order Total: Σ(product_price × quantity) for all products in order\n *   - Statistics: Real-time count aggregation by status\n *\n * @component\n * @returns {React.ReactElement} Admin orders management page with dashboard\n *//* eslint-disable react-hooks/exhaustive-deps */import React,{useEffect,useState,useCallback}from\"react\";import{motion}from\"framer-motion\";import{Search,ChevronLeft,ChevronRight,ChevronUp,ChevronDown,Package}from\"lucide-react\";import axios from\"axios\";import config from\"../../config/config\";import StatCard from\"./StatCard\";import\"./AdminPanel.scss\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminOrders=()=>{const[orders,setOrders]=useState([]);const[stats,setStats]=useState({totalOrders:0,pendingOrders:0,shippedOrders:0,deliveredOrders:0});const[searchTerm,setSearchTerm]=useState(\"\");const[filteredOrders,setFilteredOrders]=useState([]);const[sortField,setSortField]=useState(\"id\");const[sortDirection,setSortDirection]=useState(\"desc\");const[currentPage,setCurrentPage]=useState(1);const[ordersPerPage]=useState(10);const[loading,setLoading]=useState(true);useEffect(()=>{fetchData();},[]);const fetchData=async()=>{setLoading(true);await Promise.all([fetchOrders(),fetchOrderStats()]);setLoading(false);};const handleFilteringAndSorting=useCallback(()=>{if(!orders.length)return;let data=[...orders];data=data.filter(order=>{var _order$status;if(!searchTerm)return true;const term=searchTerm.toLowerCase();const idMatch=order.id.toString().includes(term);const statusMatch=(_order$status=order.status)===null||_order$status===void 0?void 0:_order$status.toLowerCase().includes(term);const orderDate=formatDate(order.date_order);const dateMatch=orderDate.includes(term);return idMatch||statusMatch||dateMatch;});data.sort((a,b)=>{let fieldA=a[sortField]||\"\";let fieldB=b[sortField]||\"\";if(sortField===\"date_order\"){fieldA=new Date(fieldA);fieldB=new Date(fieldB);}else if(typeof fieldA===\"string\"){fieldA=fieldA.toLowerCase();fieldB=fieldB.toLowerCase();}if(fieldA<fieldB)return sortDirection===\"asc\"?-1:1;if(fieldA>fieldB)return sortDirection===\"asc\"?1:-1;return 0;});setFilteredOrders(data);},[orders,searchTerm,sortField,sortDirection]);useEffect(()=>{handleFilteringAndSorting();},[handleFilteringAndSorting]);const handleSearch=value=>{setSearchTerm(value);setCurrentPage(1);};const fetchOrders=async()=>{const token=localStorage.getItem(\"access\");try{const res=await axios.get(`${config.apiUrl}/api/orders/`,{headers:{Authorization:`Bearer ${token}`}});setOrders(res.data);setFilteredOrders(res.data);}catch(err){console.error(\"Error fetching orders:\",err);}};const fetchOrderStats=async()=>{const token=localStorage.getItem(\"access\");try{const res=await axios.get(`${config.apiUrl}/api/orders/`,{headers:{Authorization:`Bearer ${token}`}});const allOrders=res.data;const pending=allOrders.filter(order=>order.status===\"Pending\").length;const shipped=allOrders.filter(order=>order.status===\"Shipped\").length;const delivered=allOrders.filter(order=>order.status===\"Delivered\").length;setStats({totalOrders:allOrders.length,pendingOrders:pending,shippedOrders:shipped,deliveredOrders:delivered});}catch(err){console.error(\"Error calculating order stats:\",err);}};const handleSort=field=>{if(sortField===field){setSortDirection(sortDirection===\"asc\"?\"desc\":\"asc\");}else{setSortField(field);setSortDirection(\"asc\");}};const renderSortIcon=field=>{if(sortField!==field)return null;return sortDirection===\"asc\"?/*#__PURE__*/_jsx(ChevronUp,{size:14}):/*#__PURE__*/_jsx(ChevronDown,{size:14});};const getStatusClass=status=>{switch(status){case\"Processing\":return\"status-processing\";case\"Shipped\":return\"status-shipped\";case\"Delivered\":return\"status-delivered\";case\"Cancelled\":return\"status-cancelled\";case\"Pending\":default:return\"status-pending\";}};const formatDate=dateString=>{if(!dateString)return\"\";const date=new Date(dateString);return date.toLocaleString(\"en-GB\",{year:\"numeric\",month:\"2-digit\",day:\"2-digit\",hour:\"2-digit\",minute:\"2-digit\",hour12:false}).replace(\",\",\"\");};const indexOfLast=currentPage*ordersPerPage;const indexOfFirst=indexOfLast-ordersPerPage;const currentSlice=filteredOrders.slice(indexOfFirst,indexOfLast);const paginate=pageNumber=>setCurrentPage(pageNumber);const nextPage=()=>{if(currentPage<Math.ceil(filteredOrders.length/ordersPerPage)){setCurrentPage(currentPage+1);}};const prevPage=()=>{if(currentPage>1){setCurrentPage(currentPage-1);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"});}return/*#__PURE__*/_jsx(\"div\",{className:\"admin-content\",children:/*#__PURE__*/_jsxs(\"main\",{className:\"admin-products\",children:[/*#__PURE__*/_jsxs(motion.div,{className:\"stat_Cards\",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:1},children:[/*#__PURE__*/_jsx(StatCard,{name:\"Total Orders\",icon:Package,value:stats.totalOrders.toLocaleString(),color:\"#6366F1\",variant:\"first\"}),/*#__PURE__*/_jsx(StatCard,{name:\"Pending Orders\",icon:Package,value:stats.pendingOrders.toLocaleString(),color:\"#F59E0B\",variant:\"fourth\"}),/*#__PURE__*/_jsx(StatCard,{name:\"Shipped Orders\",icon:Package,value:stats.shippedOrders.toLocaleString(),color:\"#10B981\",variant:\"third\"}),/*#__PURE__*/_jsx(StatCard,{name:\"Delivered Orders\",icon:Package,value:stats.deliveredOrders.toLocaleString(),color:\"#EF4444\",variant:\"second\"})]}),/*#__PURE__*/_jsxs(motion.div,{className:\"product-table-container\",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:0.2},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"product-table-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"All Orders\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search orders... (ID, Status, Date)\",onChange:e=>handleSearch(e.target.value),value:searchTerm}),/*#__PURE__*/_jsx(Search,{className:\"search-icon\",size:18})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"table-wrapper\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"product-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{onClick:()=>handleSort(\"id\"),className:\"sortable-header\",style:{textAlign:\"center\"},children:/*#__PURE__*/_jsxs(\"div\",{className:\"header-content\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Order ID\"}),renderSortIcon(\"id\")]})}),/*#__PURE__*/_jsx(\"th\",{onClick:()=>handleSort(\"date_order\"),className:\"sortable-header\",style:{textAlign:\"center\"},children:/*#__PURE__*/_jsxs(\"div\",{className:\"header-content\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Date\"}),renderSortIcon(\"date_order\")]})}),/*#__PURE__*/_jsx(\"th\",{onClick:()=>handleSort(\"status\"),className:\"sortable-header\",style:{textAlign:\"center\"},children:/*#__PURE__*/_jsxs(\"div\",{className:\"header-content\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Status\"}),renderSortIcon(\"status\")]})})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:currentSlice.length>0?currentSlice.map(order=>/*#__PURE__*/_jsxs(motion.tr,{initial:{opacity:0},animate:{opacity:1},transition:{duration:0.3},children:[/*#__PURE__*/_jsx(\"td\",{style:{textAlign:\"center\"},children:order.id}),/*#__PURE__*/_jsx(\"td\",{style:{textAlign:\"center\"},children:formatDate(order.date_order)}),/*#__PURE__*/_jsx(\"td\",{style:{textAlign:\"center\"},children:/*#__PURE__*/_jsx(\"span\",{className:`status-badge ${getStatusClass(order.status)}`,children:order.status})})]},order.id)):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"3\",className:\"no-results\",children:\"No orders found matching your search criteria\"})})})]})}),filteredOrders.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"pagination-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"pagination-info\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"pagination-text\",children:[\"Displaying \",indexOfFirst+1,\" to\",\" \",Math.min(indexOfLast,filteredOrders.length),\" of\",\" \",filteredOrders.length,\" orders\"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"pagination-controls\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:prevPage,disabled:currentPage===1,className:`pagination-button ${currentPage===1?\"disabled\":\"\"}`,children:[/*#__PURE__*/_jsx(ChevronLeft,{size:16}),/*#__PURE__*/_jsx(\"span\",{children:\"<\"})]}),Array.from({length:Math.ceil(filteredOrders.length/ordersPerPage)}).map((_,index)=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>paginate(index+1),className:`pagination-number ${currentPage===index+1?\"active\":\"\"}`,children:index+1},index)).slice(Math.max(0,currentPage-3),Math.min(Math.ceil(filteredOrders.length/ordersPerPage),currentPage+2)),/*#__PURE__*/_jsxs(\"button\",{onClick:nextPage,disabled:currentPage>=Math.ceil(filteredOrders.length/ordersPerPage),className:`pagination-button ${currentPage>=Math.ceil(filteredOrders.length/ordersPerPage)?\"disabled\":\"\"}`,children:[/*#__PURE__*/_jsx(ChevronRight,{size:16}),/*#__PURE__*/_jsx(\"span\",{children:\">\"})]})]})]})]})]})});};export default AdminOrders;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}