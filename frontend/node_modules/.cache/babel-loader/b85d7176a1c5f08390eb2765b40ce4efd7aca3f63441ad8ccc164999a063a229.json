{"ast":null,"code":"/* eslint-disable react-hooks/exhaustive-deps */import{useState,useEffect}from\"react\";import{AiOutlineSearch,AiOutlineInfoCircle}from\"react-icons/ai\";import axios from\"axios\";import config from\"../../config/config\";import\"./SearchModal.scss\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SearchModal=_ref=>{let{isOpen,onClose}=_ref;const[searchTerm,setSearchTerm]=useState(\"\");const[searchResults,setSearchResults]=useState([]);const[isAdvanced,setIsAdvanced]=useState(false);const[isLoading,setIsLoading]=useState(false);const[error,setError]=useState(\"\");const[priceRange,setPriceRange]=useState(\"\");const[fuzzyThreshold,setFuzzyThreshold]=useState(0.6);useEffect(()=>{const timer=setTimeout(()=>{if(searchTerm&&!isAdvanced){performSentimentSearch();}},300);return()=>clearTimeout(timer);},[searchTerm,isAdvanced]);const performSentimentSearch=async()=>{setIsLoading(true);setError(\"\");try{const response=await axios.get(`${config.apiUrl}/api/sentiment-search/?q=${searchTerm}`);setSearchResults(response.data);}catch(err){setError(\"Error fetching search results\");console.error(\"Search error:\",err);}finally{setIsLoading(false);}};const performFuzzySearch=async()=>{setIsLoading(true);setError(\"\");try{const params=new URLSearchParams();params.append(\"q\",searchTerm);if(priceRange)params.append(\"price_range\",priceRange);params.append(\"fuzzy_threshold\",fuzzyThreshold);const response=await axios.get(`${config.apiUrl}/api/fuzzy-search/?${params.toString()}`);setSearchResults(response.data);}catch(err){setError(\"Error fetching search results\");console.error(\"Search error:\",err);}finally{setIsLoading(false);}};const handleAdvancedSearch=e=>{e.preventDefault();if(searchTerm){performFuzzySearch();}};const handleProductClick=productId=>{window.location.href=`/product/${productId}`;onClose();};if(!isOpen)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"search-modal-overlay\",onClick:onClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"search-modal-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"button\",{className:\"common-modal-close search-modal-close\",onClick:onClose,\"aria-label\":\"Close Search Modal\",children:\"\\xD7\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Search Products\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-mode-info\",children:[!isAdvanced&&searchResults.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"sentiment-info-tooltip\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"info-icon\",type:\"button\",title:\"How Sentiment Analysis Works\",children:/*#__PURE__*/_jsx(AiOutlineInfoCircle,{})}),/*#__PURE__*/_jsxs(\"div\",{className:\"tooltip-content\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Multi-Source Sentiment Analysis:\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Score = (Positive - Negative) / Total Words\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"small\",{children:\"\\uD83D\\uDCCA Analyzed from 5 sources:\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"small\",{children:\"\\uD83D\\uDC65 Opinions (40%) \\u2022 \\uD83D\\uDCDD Description (25%)\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"small\",{children:\"\\uD83C\\uDFF7\\uFE0F Name (15%) \\u2022 \\uD83D\\uDCCB Specs (12%) \\u2022 \\uD83D\\uDDC2\\uFE0F Categories (8%)\"})]}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"small\",{children:\"Range: -1.0 (negative) to +1.0 (positive)\"})}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"small\",{children:\"Source: Liu, B. (2012) - Sentiment Analysis and Opinion Mining\"})})]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"search-modal-toggle\",onClick:()=>setIsAdvanced(!isAdvanced),children:isAdvanced?\"Sentiment Search\":\"Fuzzy Search\"})]})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:isAdvanced?handleAdvancedSearch:e=>e.preventDefault(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"search-modal-input-wrapper\",children:[/*#__PURE__*/_jsx(AiOutlineSearch,{className:\"search-modal-search-icon\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"search-modal-input\",placeholder:isAdvanced?\"Search with fuzzy matching...\":\"Search products (sentiment-based)...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),autoFocus:true})]}),isAdvanced&&/*#__PURE__*/_jsxs(\"div\",{className:\"search-modal-advanced-options\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"search-modal-option\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Price Range Filter:\"}),/*#__PURE__*/_jsxs(\"select\",{value:priceRange,onChange:e=>setPriceRange(e.target.value),className:\"search-modal-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Price Ranges\"}),/*#__PURE__*/_jsxs(\"option\",{value:\"cheap\",children:[\"Cheap (\",\"<\",\" $100)\"]}),/*#__PURE__*/_jsx(\"option\",{value:\"medium\",children:\"Medium ($100-$500)\"}),/*#__PURE__*/_jsxs(\"option\",{value:\"expensive\",children:[\"Expensive (\",\">\",\" $500)\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-modal-option\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Fuzzy Threshold:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-modal-slider-wrapper\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"range\",min:\"0.3\",max:\"1.0\",step:\"0.1\",value:fuzzyThreshold,onChange:e=>setFuzzyThreshold(parseFloat(e.target.value)),className:\"search-modal-slider\"}),/*#__PURE__*/_jsx(\"span\",{className:\"search-modal-slider-value\",children:fuzzyThreshold.toFixed(1)})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"search-modal-search-btn\",disabled:!searchTerm,children:\"Search with Fuzzy Logic\"})]})]}),isLoading&&/*#__PURE__*/_jsx(\"div\",{className:\"search-modal-loading\",children:\"Searching...\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"search-modal-error\",children:error}),/*#__PURE__*/_jsx(\"div\",{className:\"search-modal-results\",children:searchResults.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"search-modal-results-list\",children:searchResults.map(product=>{var _product$photos,_product$photos$;return/*#__PURE__*/_jsxs(\"div\",{className:\"search-modal-result-item\",onClick:()=>handleProductClick(product.id),children:[((_product$photos=product.photos)===null||_product$photos===void 0?void 0:(_product$photos$=_product$photos[0])===null||_product$photos$===void 0?void 0:_product$photos$.path)&&/*#__PURE__*/_jsx(\"img\",{src:`${config.apiUrl}/media/${product.photos[0].path}`,alt:product.name,className:\"search-modal-result-image\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-modal-result-info\",children:[/*#__PURE__*/_jsx(\"h3\",{children:product.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"search-modal-result-price\",children:[\"$\",product.price]}),isAdvanced&&product.fuzzy_score&&/*#__PURE__*/_jsxs(\"div\",{className:\"search-modal-score\",children:[\"Fuzzy Match: \",(product.fuzzy_score*100).toFixed(0),\"%\"]}),!isAdvanced&&product.sentiment_score!=null&&/*#__PURE__*/_jsxs(\"div\",{className:\"search-modal-sentiment\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sentiment-score\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Sentiment Score:\"}),\" \",product.sentiment_score.toFixed(2),/*#__PURE__*/_jsx(\"span\",{className:`sentiment-badge ${product.sentiment_score>0.1?\"positive\":product.sentiment_score<-0.1?\"negative\":\"neutral\"}`,children:product.sentiment_score>0.1?\"ðŸ˜Š Positive\":product.sentiment_score<-0.1?\"ðŸ˜ž Negative\":\"ðŸ˜ Neutral\"})]}),product.total_opinions>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"sentiment-details\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"opinion-count\",children:[\"\\uD83D\\uDCDD \",product.total_opinions,\" opinion\",product.total_opinions!==1?\"s\":\"\"]}),(product.positive_count||product.negative_count||product.neutral_count)&&/*#__PURE__*/_jsxs(\"span\",{className:\"opinion-breakdown\",children:[\"\\uD83D\\uDC4D \",product.positive_count||0,\" | \\uD83D\\uDC4E\",\" \",product.negative_count||0,\" | \\uD83D\\uDE10\",\" \",product.neutral_count||0]})]})]})]})]},product.id);})}):searchTerm&&!isLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"search-modal-no-results\",children:[\"No products found for \\\"\",searchTerm,\"\\\"\"]})})]})});};export default SearchModal;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}