{"ast":null,"code":"/* eslint-disable react-hooks/exhaustive-deps */import{useState,useContext,useEffect}from\"react\";import{AuthContext}from\"../../context/AuthContext\";import{useNavigate}from\"react-router-dom\";import axios from\"axios\";import{toast}from\"react-toastify\";import\"./PanelLogin.scss\";import config from\"../../config/config\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const LoginPanel=()=>{const[email,setEmail]=useState(\"\");const[password,setPassword]=useState(\"\");const{login}=useContext(AuthContext);const navigate=useNavigate();const[submitForm,setSubmitForm]=useState(false);const handleLogin=async()=>{if(!email||!password){toast.error(\"Please enter email and password.\");return;}try{const response=await axios.post(`${config.apiUrl}/api/token/`,{email,password});const{access}=response.data;login(access);localStorage.setItem(\"access\",access);const decoded=JSON.parse(atob(access.split(\".\")[1]));localStorage.setItem(\"loggedUser\",JSON.stringify(decoded));toast.success(\"Logged in successfully!\");setTimeout(()=>{navigate(decoded.role===\"admin\"?\"/admin\":\"/client\");},500);}catch(error){var _error$response,_error$response$data;toast.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error)||\"Invalid email or password.\");}};useEffect(()=>{if(submitForm){handleLogin();setSubmitForm(false);}},[submitForm]);const handleSubmit=e=>{e.preventDefault();setSubmitForm(true);};useEffect(()=>{const handleKeyDown=event=>{if(event.key===\"Enter\"){event.preventDefault();setSubmitForm(true);}};document.addEventListener(\"keydown\",handleKeyDown);return()=>{document.removeEventListener(\"keydown\",handleKeyDown);};},[]);return/*#__PURE__*/_jsx(\"div\",{className:\"loginPanel\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"loginPanel__container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loginPanel__image\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"loginPanel__form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Welcome back\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Please enter your details to log in.\"}),/*#__PURE__*/_jsx(\"div\",{className:\"floating-label\",children:/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"email\",name:\"email\",placeholder:\"Email\",value:email,onChange:e=>setEmail(e.target.value),required:true})}),/*#__PURE__*/_jsx(\"div\",{className:\"floating-label\",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",name:\"password\",placeholder:\"Password\",value:password,onChange:e=>setPassword(e.target.value),required:true})}),/*#__PURE__*/_jsxs(\"div\",{className:\"loginPanel__buttons\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setSubmitForm(true),children:\"Log in\"}),/*#__PURE__*/_jsx(\"span\",{className:\"loginPanel__or\",children:\"OR\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"loginPanel__signupBtn\",onClick:()=>navigate(\"/signup\"),children:\"Sign Up\"})]})]})]})});};export default LoginPanel;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}