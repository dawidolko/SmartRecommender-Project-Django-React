{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{Link}from\"react-router-dom\";import{Cpu,Layers,Settings,X}from\"react-feather\";import config from\"../../config/config\";import\"./ClientProbabilistic.scss\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Modal=_ref=>{let{isOpen,onClose,title,children}=_ref;if(!isOpen)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:onClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:title}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:onClose,children:/*#__PURE__*/_jsx(X,{size:24})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:children})]})});};const ClientFuzzyLogic=()=>{const[activeTab,setActiveTab]=useState(\"recommendations\");const[recommendationsData,setRecommendationsData]=useState([]);const[userProfile,setUserProfile]=useState({});const[fuzzySystem,setFuzzySystem]=useState({});const[ruleExplanations,setRuleExplanations]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[modalContent,setModalContent]=useState(null);const[modalTitle,setModalTitle]=useState(\"\");const[isModalOpen,setIsModalOpen]=useState(false);useEffect(()=>{fetchData();},[]);const fetchData=async()=>{const token=localStorage.getItem(\"access\");setLoading(true);setError(null);try{const response=await fetch(`${config.apiUrl}/api/fuzzy-logic-recommendations/?limit=10&debug=true`,{headers:{Authorization:`Bearer ${token}`,\"Content-Type\":\"application/json\"}});if(!response.ok){throw new Error(\"Failed to fetch fuzzy logic recommendations\");}const data=await response.json();const enhancedRecommendations=(data.recommendations||[]).map(rec=>{const imageUrl=rec.product.photos&&rec.product.photos[0]&&rec.product.photos[0].path?`${config.apiUrl}/media/${rec.product.photos[0].path}`:null;return{...rec.product,fuzzy_score:rec.fuzzy_score,category_match:rec.category_match,rule_activations:rec.rule_activations,image_url:imageUrl};});setRecommendationsData(enhancedRecommendations);setUserProfile(data.user_profile||{});setFuzzySystem(data.fuzzy_system||{});setRuleExplanations(data.rule_explanations||[]);setLoading(false);}catch(error){setError(error.message);setLoading(false);}};const TabButton=_ref2=>{let{id,label,icon:Icon}=_ref2;return/*#__PURE__*/_jsxs(\"button\",{className:`tab-button ${activeTab===id?\"active\":\"\"}`,onClick:()=>setActiveTab(id),children:[/*#__PURE__*/_jsx(Icon,{size:20}),/*#__PURE__*/_jsx(\"span\",{children:label})]});};const showModal=(title,content)=>{setModalTitle(title);setModalContent(content);setIsModalOpen(true);};const closeModal=()=>{setIsModalOpen(false);setModalContent(null);setModalTitle(\"\");};const handleViewRuleDetails=product=>{const modalContent=/*#__PURE__*/_jsxs(\"div\",{className:\"rule-details\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Fuzzy Rule Activations for \",product.name]}),/*#__PURE__*/_jsxs(\"p\",{className:\"product-info\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Fuzzy Score:\"}),\" \",product.fuzzy_score.toFixed(3),\" \",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"Category Match:\"}),\" \",product.category_match.toFixed(3)]}),/*#__PURE__*/_jsx(\"h4\",{children:\"Rule Activations:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"rule-list\",children:Object.entries(product.rule_activations||{}).map((_ref3,idx)=>{let[ruleName,activation]=_ref3;return/*#__PURE__*/_jsxs(\"div\",{className:\"rule-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"rule-name\",children:ruleName}),/*#__PURE__*/_jsxs(\"div\",{className:\"rule-bar-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"rule-bar-fill\",style:{width:`${activation*100}%`,backgroundColor:activation>0.7?\"#28a745\":activation>0.3?\"#ffc107\":\"#dc3545\"}}),/*#__PURE__*/_jsx(\"span\",{className:\"rule-activation-value\",children:activation.toFixed(3)})]})]},idx);})}),/*#__PURE__*/_jsxs(\"div\",{className:\"rule-explanation-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"How Rules Work:\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Each rule evaluates the product using \",/*#__PURE__*/_jsx(\"strong\",{children:\"fuzzy logic\"}),\". Rules use \",/*#__PURE__*/_jsx(\"strong\",{children:\"T-norms\"}),\" (min) for AND conditions and\",\" \",/*#__PURE__*/_jsx(\"strong\",{children:\"T-conorms\"}),\" (max) for OR conditions. The final score is computed using weighted average defuzzification (Mamdani-style).\"]})]})]});showModal(\"FUZZY RULE DETAILS\",modalContent);};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"});}if(error){return/*#__PURE__*/_jsxs(\"div\",{className:\"error\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Error loading data:\"}),/*#__PURE__*/_jsx(\"p\",{children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:fetchData,className:\"retry-button\",children:\"Retry\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"client-probabilistic\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"probabilistic-tabs\",children:[/*#__PURE__*/_jsx(TabButton,{id:\"recommendations\",label:\"Fuzzy Recommendations\",icon:Cpu}),/*#__PURE__*/_jsx(TabButton,{id:\"profile\",label:\"User Profile\",icon:Layers}),/*#__PURE__*/_jsx(TabButton,{id:\"rules\",label:\"Fuzzy Rules\",icon:Settings})]}),/*#__PURE__*/_jsx(Modal,{isOpen:isModalOpen,onClose:closeModal,title:modalTitle,children:modalContent}),/*#__PURE__*/_jsxs(\"div\",{className:\"tab-content\",children:[activeTab===\"recommendations\"&&/*#__PURE__*/_jsxs(\"div\",{className:\"recommendations-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"section-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Fuzzy Logic Recommendations\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Products selected using \",/*#__PURE__*/_jsx(\"strong\",{children:\"fuzzy logic\"}),\" to model uncertainty in your preferences. Each product is scored using\",\" \",/*#__PURE__*/_jsx(\"strong\",{children:\"membership functions\"}),\" and\",\" \",/*#__PURE__*/_jsx(\"strong\",{children:\"fuzzy inference rules\"}),\".\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"recommendations-list\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Recommended Products\"}),/*#__PURE__*/_jsx(\"div\",{className:\"products-grid\",children:recommendationsData.map((product,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"product-card-wrapper\",children:[/*#__PURE__*/_jsx(Link,{to:`/product/${product.id}`,className:\"product-card-link\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"product-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"product-image\",children:product.image_url?/*#__PURE__*/_jsx(\"img\",{src:product.image_url,alt:product.name}):/*#__PURE__*/_jsx(\"div\",{className:\"placeholder-image\",children:product.name.substring(0,2).toUpperCase()})}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-details\",children:[/*#__PURE__*/_jsx(\"h4\",{children:product.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"product-price\",children:[\"$\",product.price]}),/*#__PURE__*/_jsxs(\"div\",{className:\"fuzzy-scores\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"score-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"score-label\",children:\"Fuzzy Score:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"score-bar\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"score-fill\",style:{width:`${product.fuzzy_score*100}%`}}),/*#__PURE__*/_jsxs(\"span\",{children:[(product.fuzzy_score*100).toFixed(1),\"%\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"score-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"score-label\",children:\"Category Match:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"score-bar\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"score-fill secondary\",style:{width:`${product.category_match*100}%`}}),/*#__PURE__*/_jsxs(\"span\",{children:[(product.category_match*100).toFixed(1),\"%\"]})]})]})]})]})]})}),/*#__PURE__*/_jsx(\"button\",{className:\"view-rules-button\",onClick:()=>handleViewRuleDetails(product),children:\"View Rule Activations\"})]},idx))})]})]}),activeTab===\"profile\"&&/*#__PURE__*/_jsxs(\"div\",{className:\"profile-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"section-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Your Fuzzy User Profile\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Your profile is built using \",/*#__PURE__*/_jsx(\"strong\",{children:\"fuzzy logic\"}),\" to model uncertainty and imprecision in your shopping preferences.\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-cards\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"Profile Type\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"highlight\",children:userProfile.profile_type||\"Unknown\"}),/*#__PURE__*/_jsx(\"p\",{className:\"subtext\",children:userProfile.profile_type===\"authenticated\"?\"Based on your purchase history\":\"Based on your browsing session\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"Price Sensitivity\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sensitivity-display\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sensitivity-bar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"sensitivity-fill\",style:{width:`${(userProfile.price_sensitivity||0.5)*100}%`}})}),/*#__PURE__*/_jsxs(\"span\",{className:\"sensitivity-value\",children:[((userProfile.price_sensitivity||0.5)*100).toFixed(0),\"%\"]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"subtext\",children:userProfile.price_sensitivity>0.7?\"Highly price-sensitive (prefers budget options)\":userProfile.price_sensitivity<0.3?\"Low price sensitivity (prefers premium products)\":\"Moderate price sensitivity\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"category-interests\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Your Favorite Categories\"}),/*#__PURE__*/_jsx(\"p\",{className:\"explanation\",children:\"These categories are ranked based on your shopping behavior. The bar shows your interest level from 0% (no interest) to 100% (highest interest).\"}),/*#__PURE__*/_jsx(\"div\",{className:\"interests-list\",children:(userProfile.top_interests||[]).map((_ref4,idx)=>{let[category,degree]=_ref4;return/*#__PURE__*/_jsxs(\"div\",{className:\"interest-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"interest-header\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"category-name\",children:category}),/*#__PURE__*/_jsxs(\"span\",{className:\"interest-percentage\",children:[(degree*100).toFixed(0),\"%\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"interest-bar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"interest-fill\",style:{width:`${degree*100}%`}})})]},idx);})})]})]}),activeTab===\"rules\"&&/*#__PURE__*/_jsxs(\"div\",{className:\"rules-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"section-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"How Recommendations Are Made\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Our system uses \",/*#__PURE__*/_jsx(\"strong\",{children:\"6 intelligent rules\"}),\" to find the best products for you. Each rule looks at different aspects like price, quality, and category match.\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"rules-list\",children:ruleExplanations.map((rule,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"rule-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"rule-header\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"rule-number\",children:[\"Rule \",idx+1]}),/*#__PURE__*/_jsx(\"h3\",{children:rule.rule})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rule-body\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"rule-explanation\",children:/*#__PURE__*/_jsx(\"p\",{className:\"rule-interpretation\",children:rule.interpretation})}),/*#__PURE__*/_jsxs(\"div\",{className:\"rule-details\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"rule-detail-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"detail-label\",children:\"When:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"detail-value\",children:rule.condition})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rule-detail-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"detail-label\",children:\"Then:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"detail-value\",children:rule.consequence})]})]})]})]},idx))}),/*#__PURE__*/_jsxs(\"div\",{className:\"fuzzy-logic-explanation\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"How It Works Behind the Scenes\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"explanation-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"explanation-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"explanation-icon\",children:\"1\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"Analyze Product\"}),/*#__PURE__*/_jsx(\"p\",{children:\"We look at price, quality ratings, and popularity for each product.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"explanation-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"explanation-icon\",children:\"2\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"Apply Rules\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Each of the 5 rules evaluates how well the product matches your preferences.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"explanation-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"explanation-icon\",children:\"3\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"Calculate Score\"}),/*#__PURE__*/_jsx(\"p\",{children:\"All rule results are combined to create a final recommendation score.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"explanation-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"explanation-icon\",children:\"4\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"Rank Products\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Products with the highest scores are shown first in your recommendations.\"})]})]})]})]})]})]});};export default ClientFuzzyLogic;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}